// Config profile metadata
params {
    config_profile_name = 'FUB Curta'
    config_profile_description = 'Freie Universit√§t Berlin HPC cluster (Curta) profile'
    config_profile_contact = 'hpc@zedat.fu-berlin.de'
    config_profile_url = 'https://www.fu-berlin.de/en/sites/high-performance-computing/index.html'

    max_cpus = 32
    max_memory = 385.GB
    max_time = 14.d
    // These parameters cover all 166 (162 in 'main' and 4 in 'begendiv') but the 4 x 772.GB compute nodes on 'main'
}

def membership = ['/bin/bash', '-c', 'groups'].execute().text.trim()

// Slurm configuration parameters
process {
    executor = 'slurm'
    maxRetries = 3
    clusterOptions = { (membership.startsWith("b") ? '--partition=begendiv,main ' : '--partition=main ') << ( task.time <= 3.h ? '--qos=hiprio' : ( task.time <= 3.d ? '--qos=prio' : '--qos=standard' ) ) }
}

// Singularity parameters
singularity {
    enabled = true
    autoMounts = true
}

cleanup = true
